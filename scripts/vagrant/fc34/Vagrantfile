Vagrant.configure("2") do |config|
  config.vm.box = "fedora/34-cloud-base"
  config.vm.box_version = "34.20210423.0"

  config.ssh.forward_agent = true
  config.ssh.forward_x11 = true

  config.vbguest.auto_update = false
  config.vm.provider "virtualbox" do |vb|
    vb.gui = false
    vb.memory = "2048"
  end

  rpm_url = ENV['rpm_url']
  http_proxy = ENV['http_proxy']
  https_proxy = ENV['https_proxy']

  config.vm.provision "ansible" do |ansible|
    ansible.playbook = "../../demo/site.yml"
    ansible.extra_vars = {
      rpm_url: rpm_url,
      http_proxy: http_proxy,
      https_proxy: https_proxy
    }
  end
end
